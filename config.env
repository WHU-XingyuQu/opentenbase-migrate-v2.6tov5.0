#!/usr/bin/env bash
# =============== 用户配置（可直接编辑；也可用环境变量覆盖）==================

# v2.6 客户端 bin 目录
V26_BIN="${V26_BIN:-/data/opentenbase/install/opentenbase_2.6.0/bin}"
# v5.0 客户端 bin 目录
V50_BIN="${V50_BIN:-/data/opentenbase/install/opentenbase_5.0/bin}"

# v2.6 Coordinator 连接
V26_HOST="${V26_HOST:-127.0.0.1}"
V26_PORT="${V26_PORT:-30004}"
V26_USER="${V26_USER:-otb}"

# v5.0 Coordinator 连接
V50_HOST="${V50_HOST:-127.0.0.1}"
V50_PORT="${V50_PORT:-55432}"
V50_USER="${V50_USER:-otb}"

# v5.0（可选）GTM 端口（用于日志提示与健诊）
V50_GTMD_PORT="${V50_GTMD_PORT:-21010}"

# v5.0 数据目录（用于一次性清理不兼容 GUC；可留空跳过）
V50_CN_DATA_DIR="${V50_CN_DATA_DIR:-/data/otb/data/coord}"
V50_DN1_DATA_DIR="${V50_DN1_DATA_DIR:-/data/otb/data/dn001}"

# 迁移工作根目录
MIG_ROOT="${MIG_ROOT:-/data/otb/migrate_26to50}"
# 并行恢复的并发度
JOBS="${JOBS:-4}"
# 每库抽样对比的表数量
SAMPLE_TABLES="${SAMPLE_TABLES:-30}"

# 切换：是否启用本机端口转发（旧端口 → 新端口），默认 false
CUTOVER_USE_IPTABLES="${CUTOVER_USE_IPTABLES:-false}"
# 旧/新端口（本机转发用）
CUTOVER_OLD_PORT="${CUTOVER_OLD_PORT:-30004}"
CUTOVER_NEW_PORT="${CUTOVER_NEW_PORT:-55432}"

# === 无须改动：内部变量 ================================================
STAMP="$(date +%Y%m%d_%H%M%S)"
LOG_DIR="$MIG_ROOT/logs"
DUMP_DIR="$MIG_ROOT/dump-$STAMP"
mkdir -p "$LOG_DIR" "$DUMP_DIR"
